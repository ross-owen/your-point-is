<section
  id="participantStatus"
  class="hidden border rounded shadow-sm p-4 mx-auto"
>
  <div id="containerParticipants">
    <h4>Who's here?</h4>
  </div>
</section>

<script>
  //function that updates list of participants. The list is stored in sever side and passed as a message via socket depending on the event (new user joined, user left, users waiting to enter the room, user voted, user to vote)
  function updateParticipants(receivedParticipants) {
    document.getElementById('participantStatus').classList.remove('hidden');
    let container = document.getElementById('containerParticipants');
    container.innerHTML = `<h4>Who's here?</h4>`;

    //creating html that depending on the status of the user, different icons will be displayed.
    container.innerHTML += receivedParticipants
      .map(([name, status]) => {
        return `<div class='user'>
    <img src="/images/site/user.png" alt="user-icon" />
    <p>${name}</p>
    ${
      status === 'waiting'
        ? `<p class='${name.replace(/ /g, '')} waiting'>🍕</p>`
        : status === 'voting'
        ? `<p class='${name.replace(/ /g, '')} unvoted'>❔</p>`
        : `<p class='${name.replace(/ /g, '')} voted'>✅</p>`
    }
  </div>`;
      })
      .join('');
  }

  //function to change user status. Not currently used as controlled at server side
  function updateVoteStatus(displayName, remove) {
    const voteIcon = document.querySelectorAll(
      `.${displayName.replace(/ /g, '')}`
    );
    voteIcon.forEach((p) => {
      if (remove) {
        if (p.classList.contains('unvoted')) {
          p.classList.remove('hidden');
        } else {
          p.classList.add('hidden');
        }
      } else {
        if (!p.classList.contains('unvoted')) {
          p.classList.remove('hidden');
        } else {
          p.classList.add('hidden');
        }
      }
    });
  }

  //function to change user status. Not currently used as controlled at server side
  function resetVoteStatus() {
    const voteIcon1 = document.querySelectorAll('.unvoted');
    const voteIcon2 = document.querySelectorAll('.voted');
    voteIcon1.forEach((p) => {
      p.classList.remove('hidden');
    });
    voteIcon2.forEach((p) => {
      p.classList.add('hidden');
    });
  }
</script>
